## Application and service deployment

### What will you need for deployment 
1. Installed MSSQL server. You can use [SQLEXPRESS](http://www.microsoft.com/en-us/sqlserver/get-sql-server/try-it.aspx).
2. [Microsoft .Net 3.5 Service Pack 1](http://www.microsoft.com/en-us/download/details.aspx?id=25150)
3. [.NET Framework 4.5](http://www.microsoft.com/en-us/download/details.aspx?id=30653)
4. Your server must have IIS for hosting
5. [Web-Deploy](http://www.iis.net/downloads/microsoft/web-deploy) this installs Web Deploy (and its underlying executable, MSDeploy.exe) on your server. Also it installs the Web Deploy Handler and integrates it with the Web Management Service. You can find how to configure and install it here [Installing and Configuring Web Deploy](http://www.iis.net/learn/install/installing-publishing-technologies/installing-and-configuring-web-deploy)

### Deployment
1. Download sources from github repository.
2. Create new Database on your Database Server. We are using name "Ach" for database by default, if you want another name do not forget change it for your one in scripts.
3. Go to \Build\ folder and run Build.Local.cmd
4. Change connection string in such places:
  \Build\Assembly\Packages\Ach.Fulfillment.Web.SetParameters.xml,
  \Build\Assembly\Service\Ach.Fulfillment.Scheduler.install.
6. Go to \Build\Assembly\setup.cmd change connection string to proper one and if you are deploying from one machine to another then set DeploymentServer also.
7. Run RunSetup.cmd
8. Go to Web folder, open Web.config - here in section AppSettings we have <add key ="DefaultUser" value="admin"/> - it is login for default user.
It will be used for non-authentificated requests. We get company payment information from PartnerDetails of this user.

## Job configuration
1. Go to quartz_jobs.config file 
2. For each job there is  "job-data-map" section where additional data for job should be added.
   Find GenerateAchFilesJob and fill parameters in "job-data-map" section.
3. Open "trigger" section - there you can configure when your job will be run. Change cron-expression for your one. For more information look at http://en.wikipedia.org/wiki/Cron


## API

**CREATE TRANSACTION**

http://servicehost/transaction

Creates new transaction in database based on data in request. 
Transaction will have status Created and will be put in queue. After that job will add it to next batch.

**POST**

**Accept:** application/json

**Content-Type:** application/json

**Request:**

    {
      "individualIdNumber" : "123456789012345",
      "receiverName" : "ReceiverName",
      "entryDescription":"PAYROLL",
      "entryDate":"01.01.2012",
      "transactionCode":"22", 
      "transitRoutingNumber":"123456789",
      "dfiAccountId":"12345678901234567", 
      "amount":"123,00", 
      "entryClassCode":"PPD", 
      "callbackUrl":"http://send.callback.here",
      "paymentRelatedInfo":"",
      "serviceClassCode":"200"
    }

**Response:**
    {
        "transactionId":123456789012345
    }

**GET TRANSACTION**

http://servicehost/transaction/id

Returns the transaction based on an id. This transaction id is generated by the server when the transaction is first created. It is returned in the repsonse

**GET**

**Accept:** application/json

**Content-Type:** application/json

**Response:**

    {
      "transactionId":123456789012345,
      "status":"Created",
      "individualIdNumber" : "123456789012345",
      "receiverName" : "ReceiverName",
      "entryDescription":"PAYROLL",
      "entryDate":"01.01.2012",
      "transactionCode":"22", 
      "transitRoutingNumber":"123456789",
      "dfiAccountId":"12345678901234567", 
      "amount":"123,00", 
      "entryClassCode":"PPD", 
      "callbackUrl":"http://send.callback.here",
      "paymentRelatedInfo":"",
      "serviceClassCode":"200"
    }
